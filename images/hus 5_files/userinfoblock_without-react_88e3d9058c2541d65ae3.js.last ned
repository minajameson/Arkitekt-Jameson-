/*! Version: 4.9.30; Third Party Notices: https://res-1.cdn.office.net/midgard/versionless/tpn-2387ba85051762ba02668f963932b12956c527e90c7e901f19486ef7a270679a6d68101f2a5da06bef724e9b888e249405a95f154be8e6005f5ef7815deb43f0.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[267],{1197:function(e,t,n){"use strict";n.r(t);var r=n(2100),o=n(2061),a=n(29),i=n(162),c=n(1116),u=n(1919),s=n(1297),l=n(213),d=n(930),f=n(0),p=n(128),g=n(1662),b=n(117),v=n(1492),m=n(706),h=n(684),j=n(735),C=n(418),O=n(145),y=n(1450),S=n(1372),w=n(701),k=n(417),x=n(1282),P=n(1474),A=n(1490),E=n(26),I=n.n(E),T=n(44),L=n(45),D=n(85),N=n(84),U=n(50),R=n(1631),V=n(1310),_=n(1155),K=n(1172),M=n(2077),B=n(1720),F=n(200),z=n(3),W=Object(z.declareStringWithPlaceholders)("lpc-core.inferredContact.newInformationBlock.message"),q=Object(z.declareString)("lpc-core.inferredContact.newInformationBlock.link"),H=n(13),Z=n(112),J=n(416),Q=Object(Z.c)((function(e){return Object(H.cb)({messageBarContainer:{padding:"".concat(J.h,"px ").concat(J.i,"px ").concat(J.f,"px ").concat(J.i,"px")},root:{border:"1px solid ".concat(e.palette.neutralLighter),borderRadius:"2px",selectors:{"& .ms-Link":{paddingLeft:"0px"}}},iconContainer:{marginTop:"14px",marginLeft:"".concat(J.i,"px"),fontSize:"13px"},text:{margin:"".concat(J.i,"px ").concat(J.h,"px ").concat(J.i,"px 6px")}})}));function G(e){var t=function(){if("undefined"==typeof Reflect||!I.a)return!1;if(I.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(I()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(U.a)(e);if(t){var o=Object(U.a)(this).constructor;n=I()(r,arguments,o)}else n=r.apply(this,arguments);return Object(N.a)(this,n)}}var Y=function(e){Object(D.a)(n,e);var t=G(n);function n(){return Object(T.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"render",value:function(){var e=this.props,t=e.person,n=e.onShowDetailsClicked,r=Q(this.props.theme),o=t&&(t.displayName||t.email&&t.email.Address);if(!o)return null;var a=f.createElement(K.a,{onClick:n,href:"#"},q());return f.createElement("div",{className:r.messageBarContainer},f.createElement(M.a,{messageBarType:B.a.info,isMultiline:!0,styles:r},f.createElement(R.a,{text:W,placeholders:{name:o,newInfo:a}})))}}]),n}(F.a);var $=Object(V.a)(Y,(function(e){return{componentName:"InferredContactCard",identifier:e.person.lpcKey.key,logProperties:{propertyNames:e.properties}}})),X=Object(_.a)($),ee=n(1454),te=(n(8),n(460)),ne=n(122),re=n(260),oe=n(250),ae=(n(86),n(686),n(682),n(355)),ie=(n(147),n(523),n(837));var ce=n(1871),ue=n(1689),se=z.declareString("lpc-core.LivPersonaCardStrings.userInfoBlockStrings.emptyContactMessage"),le=n(595),de=Object(le.a)((function(e){return{noContactInfoStyles:{color:e.palette.neutralSecondary,padding:"0 ".concat(J.l,"px"),fontSize:e.fonts.small.fontSize},tagsStyles:{padding:"".concat(e.spacing.s2," 0")}}})),fe=Object(i.a)((function(e,t,n){return function(){!function(e,t){var n=t.applicationContext,r=t.renderingContext,o=Object(oe.b)(n);n.settings.isImmersiveProfileEnabled&&!!o&&o?(Object(ne.k)(e,t),n.dispatch(Object(re.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:r.windowId,navigationStartCheckpoint:Object(te.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Contact")):(n.dispatch(Object(re.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1})),n.settings.isNewOofDesignEnabled||Object(ie.a)(n,e))}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger})}})),pe=Object(i.a)((function(e,t,n){return function(){!function(e,t){var n=t.applicationContext,r=t.renderingContext,o=Object(oe.b)(n);n.settings.isImmersiveProfileEnabled&&!!o&&o?(Object(ne.k)(e,t),n.dispatch(Object(re.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:r.windowId,navigationStartCheckpoint:Object(te.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Contact")):(n.dispatch(Object(re.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1})),n.settings.isNewOofDesignEnabled||Object(ie.a)(n,e))}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger})}})),ge=Object(i.a)((function(e,t,n){return function(){!function(e,t){var n=Object(oe.b)(t.applicationContext);Object(ne.k)(e,t),t.applicationContext.dispatch(Object(re.e)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:t.renderingContext.windowId,navigationStartCheckpoint:Object(te.a)(),shouldResetHistory:!1,personaCorrelationId:t.applicationContext.getPersonaCorrelationId(e.lpcKey)})),n&&n.renderExpandedView(t.applicationContext,"Contact"),Object(ae.b)(t.applicationContext.dispatch)}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger}),Object(A.b)(e,t)}}));var be=Object(p.c)((function(e){var t=Object(b.c)(e,"Card"),n=!!Object(b.l)(e,t),r=!!(t?Object(b.g)(e,t.lpcKey):void 0),o=O.a.getSelectors(e).settings.isPSTNWorkaroundActive,i=O.a.getSelectors(e).settings.isRichAvailabilityInfoEnabled,c=i&&Object(a.p)(t)?j.a.getSelectors(e).getTimeZoneOffset(t.lpcKey):void 0,u=t&&m.a.getSelectors(e).getContactTags(t.lpcKey.key)||[],s=O.a.getSelectors(e).settings.isNextAvailabilityEnabled,l=s&&Object(a.p)(t)?j.a.getSelectors(e).getNextAvailability(t.lpcKey):void 0,d=Object(a.p)(t)?C.a.getSelectors(e).getPersonaPresence(t.lpcKey):void 0,f=Object(a.p)(t)?Object(v.a)(e,t.lpcKey):void 0;return{isMePage:n,currentPersona:t,hasInferredContactData:r,isPSTNWorkaroundActive:o,isNextAvailabilityEnabled:s,isRichAvailabilityInfoEnabled:i,timeZoneOffset:c,canUpdateProfileVideo:Object(a.p)(t)&&n&&Boolean(!h.a.getSelectors(e).getProfileVideoPlaybackUrl(t.lpcKey)),nextAvailability:l,richPresence:d,oof:f,tags:u}}))(Object(x.a)((function(e){var t,n,i,p,b,v,m=e.person,h=[],j=e.tags,C=Object(d.a)(),O=de(C);if(Object(a.p)(m)){var x=Object(a.g)(m,e.isPSTNWorkaroundActive);n={contactType:"phone",content:Object(a.l)(x).map((function(e){return{displayString:e.PhoneNumber,hrefLink:e.PhoneUrl,fieldType:e.Type}})).slice(0,2)},i=(p=Object(ce.c)(m)).address?{contactType:"location",content:Object(ce.a)([p.address],[p.address])}:void 0;var A=[m.email?m.email.Address:""].concat(m.extraEmails.map((function(e){return e.Address}))).filter((function(e){return!Object(l.e)(e)})).slice(0,2);t={contactType:"email",content:Object(ce.a)(A,A).slice(0,2)};b=e.lpcAppContext.settings.isProfileVideoEnabled&&e.canUpdateProfileVideo?{contactType:"updateprofilevideo",content:Object(ce.a)([Object(ee.j)()],["updateprofilevideo"])}:void 0,v=m.isExplicitContact}if(Object(s.a)({componentName:"ContactBlock",identifier:m.lpcKey.key,logProperties:{emailCount:t?t.content.length.toString():"0",phoneCount:n?n.content.length.toString():"0",hasLocation:Boolean(p),locationType:p?Boolean(p.address)&&p.locationType:"",isInferredContactsEnabled:e.lpcAppContext.settings.isInferredContactsEnabled,isExplicitContact:v,hasInferredContactData:e.hasInferredContactData,isContactMergeSuggestionsEnabled:Object(w.b)(e.lpcAppContext),isContactCategoriesEnabled:Object(y.a)(e.lpcAppContext),contactCategoriesCount:j?j.length.toString():"0",isMe:e.isMePage,isTimeZoneEnabled:e.isRichAvailabilityInfoEnabled,hasTimeZoneData:void 0!==e.timeZoneOffset,isNextAvailabilityEnabled:e.isNextAvailabilityEnabled,hasNextAvailabilityData:Boolean(e.nextAvailability&&e.richPresence)}}),Object(y.a)(e.lpcAppContext)&&(null==j?void 0:j.length)){var E=j,I=f.createElement(u.a,{logger:e.lpcAppContext.logger,featureName:"ContactCategories",eventFieldMap:P.b},f.createElement("div",{className:O.tagsStyles},f.createElement(r.a,{contactId:m.contactId||"",showAll:!1,showDelete:function(){return!1},tags:E,onShowMoreClick:pe(m,e.lpcAppContext,e.renderingContext),onTagClick:function(t){Object(g.a)(e.lpcAppContext,t)}}))),T=f.createElement(o.a,{tagList:I});h=h.concat(T)}if(e.shouldShowInferredContact){var L=Object(S.c)(e.inferredContact);h=h.concat(f.createElement(X,{person:m,properties:L,onShowDetailsClicked:pe(m,e.lpcAppContext,e.renderingContext)}))}var D=[t,n,i,b].filter((function(e){return e}));0!==D.length||e.shouldShowInferredContact||(h=h.concat(function(e){var t=de(e);return f.createElement("div",{className:t.noContactInfoStyles},se())}(C)));var N=[],U=Object(c.a)(e.richPresence);if(e.isNextAvailabilityEnabled&&void 0!==e.nextAvailability){var R=Object(ce.b)(e.nextAvailability,e.richPresence,e.oof,U,e.lpcAppContext.culture,e.isMePage,Object(k.d)(e.lpcAppContext));void 0!==R&&N.push({contactType:"nextavailability",content:[R]})}return void 0!==e.timeZoneOffset&&N.push({contactType:"timezone",content:[Object(ce.d)(e.timeZoneOffset,Object(k.b)(e.lpcAppContext),e.isMePage)]}),f.createElement(ue.a,{onTitleClick:fe(m,e.lpcAppContext,e.renderingContext),onFooterClick:pe(m,e.lpcAppContext,e.renderingContext),onUpdateProfileVideoClick:ge(m,e.lpcAppContext,e.renderingContext),showLoading:!m,additionalChildren:h,additionalAvailabilityInfo:N,contacts:D,hideTitle:!1})})));t.default=be},1282:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var r=n(26),o=n.n(r),a=n(5),i=n.n(a),c=n(44),u=n(45),s=n(85),l=n(84),d=n(50),f=n(468),p=n(674),g=n(1244),b=n(0),v=n(142);function m(e){var t=function(){if("undefined"==typeof Reflect||!o.a)return!1;if(o.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=o()(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var h=function(e){var t;return(t=function(t){Object(s.a)(r,t);var n=m(r);function r(){return Object(c.a)(this,r),n.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){var t=Object(p.b)(this).getSingleton(v.a),n=i()(i()({},this.props),{lpcAppContext:t});return b.createElement(e,i()({},n))}}]),r}(b.Component)).contextTypes=i()({},f.b),t};t.a=function(e){return Object(g.a)(h(e))}},1287:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(511),o=n(0),a=n(678);function i(){return Object(o.useContext)(a.a)||Object(r.throwError)("LPCAppContext not found.")}},1294:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return C})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return k}));var r=n(57),o=n.n(r),a=n(3),i=n(17),c=n(1142),u=n(65),s=Object(a.declareString)("datetime-formatting.contactDetails.localTimeLabel"),l=Object(a.declareString)("datetime-formatting.contactDetails.myTimeZoneLabel"),d=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.timeZoneBehind"),f=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.timeZoneAhead"),p=Object(a.declareString)("datetime-formatting.contactDetails.sameTimeZone"),g=Object(a.declareString)("datetime-formatting.contactDetails.separator"),b=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.freeFrom"),v=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.freeUntil"),m=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.oofUntil"),h=Object(a.declareString)("datetime-formatting.contactDetails.freeToday"),j=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.dateAndTime"),C=Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.presenceAndNextAvailability");function O(e,t,n){var r=g();return n?e:"".concat(e," ").concat(r," ").concat(t)}function y(e,t){var n=new Date,r=Object(u.g)(n);if(r===e)return p();var o=r-e,a=Object(c.getShortDurationFromHoursDifferenceString)(n,o,t);return o>0?f({p0:a}):d({p0:a})}function S(e,t,n,r){void 0===r&&(r=!1);var a=Intl.DateTimeFormat(t,{day:"2-digit",month:"short"}).format(e);if(r)return a;var i=new Date(o()()),c=e.getDay()===i.getDay(),u=Intl.DateTimeFormat(t,{hour:"numeric",minute:"2-digit",hour12:!n}).format(e);return c?u:j({date:a,time:u})}function w(e,t,n,r,o){if((t!==n||"Unknown"!==n)&&void 0!==e){if(t===n&&"Free"===n)return h();var a,c=(a=new Date(e),new Date(a.getTime()-a.getTimezoneOffset()*i.q));if("Oof"===t)return k(c,r,o);var u=S(c,r,o);return"Free"===n?b({time:u}):v({time:u})}}function k(e,t,n){if(void 0!==e){var r=S(e,t,n,!0);return m({time:r})}}},1297:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),o=n(642),a=n(0),i=n(683),c=n(1356);function u(e){var t=Object(i.c)(),n=Object(i.d)(),u=e.identifier,s=e.logProperties,l=n+e.componentName,d=Object(a.useRef)(null),f=Object(a.useRef)(null),p=Object(a.useRef)(null),g=Object(a.useRef)(0);Object(a.useEffect)((function(){return null===d.current&&(d.current=c()),function(){f.current||(f.current=c());var e=d.current&&f.current?f.current-d.current:void 0,n=void 0!==e&&Math.round(e).toString()||"";if(t){var o=Object(r.__assign)({component:l,duration:n,renderCount:g.current.toString()},p.current);t(l,o)}d.current=null,p.current=null,f.current=null,g.current=0}}),[u,l]),Object(a.useEffect)((function(){Object(o.a)(s,p.current)||(g.current++,f.current=c(),p.current=s)}),[l,s])}},1310:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(0),a=n(1297);function i(e,t){return function(n){var i=t(n);return Object(a.a)(i),o.createElement(e,Object(r.__assign)({},n))}}},1312:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r={Accept:"application/json","Content-Type":"application/json"},o={convertPropertiesToPascalCase:!1,defaultResponseObject:!1}},1313:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(17),o=n(32),a=n(466);function i(e,t){return Object(o.format)(t.timeFormats.todayShort,e,new Date,t,void 0).trim()}function c(e,t,n){void 0===n&&(n=new Date);var r=Object(a.d)(n,e);return Object(o.format)(t.timeFormats.todayShort,r,n,t,void 0,e).trim()}function u(e,t,n,a){var c=new Date(Date.UTC(0,0,0,0,0,t)),u=new Date(c.getTime()+c.getTimezoneOffset()*r.q),s=new Date(Date.UTC(0,0,0,0,0,n)),l=new Date(s.getTime()+s.getTimezoneOffset()*r.q),d=i(u,a),f=i(l,a),p=Object(o.formatTimeZone)(a.timeFormats.timeZone,e);return"".concat(d," - ").concat(f," (").concat(p,")")}},1315:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(5),o=n.n(r),a=n(8),i=n.n(a),c=n(36);function u(e){var t=e.parsedResponse;return t||"number"==typeof t||"boolean"==typeof t||"string"==typeof t?{state:"success",data:t}:{state:"no_data"}}function s(e){return"rest_provider"===(null==e?void 0:e.errorCode)?{state:"error",errorCode:e.errorCode}:401===(null==e?void 0:e.statusCode)?{state:"error",errorCode:"unauthorized"}:404===(null==e?void 0:e.statusCode)?{state:"error",errorCode:"not_found"}:(t=null==e?void 0:e.statusCode,Boolean(t&&t>=500&&t<600)?{state:"error",errorCode:"server_error"}:{state:"error",errorCode:"unknown_error"});var t}function l(){return i.a.resolve({state:"no_data"})}function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(o()({},t),{clientScenario:t.clientScenario,requestId:null!==(e=t.requestId)&&void 0!==e?e:Object(c.a)()})}function f(e,t){if(!e)return l;var n="function"==typeof e?e():i.a.resolve(e);return function(){return n.then((function(e){return t(e).then(u).catch(s)}))}}},1321:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return w})),n.d(t,"f",(function(){return k})),n.d(t,"g",(function(){return x})),n.d(t,"h",(function(){return P})),n.d(t,"e",(function(){return A}));var r=n(347),o=n(29),a=n(350),i=n(97),c=n(111),u=n(77),s=n(591),l=n(694),d=n(104),f=n(1388),p=n(465),g=n(8),b=n.n(g),v=n(668),m=n(36),h=n(86);function j(e){var t=e.scenarioName,n=e.lpcAppContext,r=e.logger,o=e.persona,a=e.operation,i=e.successAction,c=e.errorAction,u=Boolean(a);Object(v.a)({scenarioName:t,featureName:"HostAppCallbacks",requestId:Object(m.a)(),operation:function(){return u&&a?(a(o&&Object(h.a)(n.getState(),o,n.hostAppConfiguration.loggedInUserUpn)),b.a.resolve()):b.a.reject("HostApp does not implement the callback")},monitorStarter:r,successAction:function(e){n.dispatch(i())},errorAction:function(){n.dispatch(c({HostAppCallbackNotImplemented:!u}))},treatAsExpectedError:function(e){return!u}})}var C=n(479);function O(e){var t=e.person,n=e.lpcAppContext,r=e.sectionType,o=e.renderingContext,a=e.logger;Object(l.a)(r)?n.dispatch(Object(c.d)({personaLpcKey:t.lpcKey,sectionType:r})):n.dispatch(Object(u.u)()),C.a(t,n,o,a)}function y(e,t,n){t.dispatch(Object(c.c)({personaLpcKey:e,sectionType:n}))}function S(e){var t=e.personaLpcKey,n=e.lpcAppContext,r=e.sectionType,a=e.renderingContext,i=e.focusPropertyUri,s=e.logger,f=Object(d.b)(n.getState(),t);Object(o.p)(f)&&f.olsPersonaId?("PersonaBodies"===i?n.dispatch(Object(c.a)({personaLpcKey:t,contactId:f.olsPersonaId,sectionType:r})):Object(l.a)(r)?n.dispatch(Object(c.t)({personaLpcKey:t,contactId:f.olsPersonaId,sectionType:r})):n.dispatch(Object(u.v)()),C.d(f,f.olsPersonaId,n,a,s,i)):console.error("Cannot edit contact")}function w(e){var t=e.applicationContext,n=e.phoneType,o=e.contactNumber,a=e.annotation,i=e.persona,u=e.expandedViewSection,l=e.props,d=e.logger,f=t.hostAppConfiguration.actionCallbacks,p=f&&f.handleContactNumber,g=C.b(n);if(t.dispatch(u?Object(c.l)({phoneType:n,section:u,logger:d}):Object(c.q)({phoneType:n})),p&&a&&i)j({scenarioName:"ContactActionCreatorsHandleContactNumber",lpcAppContext:t,logger:d,persona:i,operation:p?function(e){return e&&p(o,a,g,e,l,d)}:void 0,successAction:s.d,errorAction:s.c});else{var b={openType:"CurrentTab",hrefLink:o};Object(r.a)(b,t)}}function k(e,t){var n=t.persona,r=t.props,o=t.expandedViewSection,i=t.shouldCloseExpandedView,u=void 0!==i&&i,s=t.applicationContext,l=t.logger;"Outlook_Android"===s.hostAppConfiguration.source||"Outlook_iOS"===s.hostAppConfiguration.source||"OutlookMobileAndroid"===s.hostAppConfiguration.source||s.hostAppConfiguration.source,s.dispatch(o?Object(c.i)({shouldCloseExpandedView:u,windowId:(null==r?void 0:r.windowId)||a.a,section:o,logger:l}):Object(c.p)({logger:l})),Object(p.g)(s,l)({persona:n,recipientId:e,properties:r})}function x(e,t,n,r,o,s){e.dispatch("Header"===n?Object(u.l)():"UserInfoView"===n?Object(c.r)({logger:r}):Object(c.m)({section:n})),Object(f.b)(t,e,r,o,(function(){e.dispatch(Object(i.j)({windowId:a.a,shouldCloseCard:Boolean(s)}))}))}function P(e,t){e.dispatch(Object(c.o)()),Object(r.a)(t,e)}function A(e,t){t.dispatch(Object(c.k)()),Object(r.a)(e,t)}},1339:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(4),o=Object(r.a)("CopyToClipboardSucceededAction",{featureName:"DOMEvent",getLogProperties:function(e){return{targetName:e.targetName}}}),a=Object(r.a)("CopyToClipboardFailedAction",{featureName:"DOMEvent",getLogProperties:function(e){return{targetName:e.targetName}}})},1356:function(e,t,n){(function(t){(function(){var n,r,o,a,i,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-i)/1e6},r=t.hrtime,a=(n=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*t.uptime(),i=a-c):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,n(929))},1363:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(98),o=n.n(r),a=n(1402),i=n(213),c=n(253),u=n(44),s=n(45),l=function(){function e(){Object(u.a)(this,e)}return Object(s.a)(e,[{key:"load",value:function(e,t,n){if(this.isLoaded(e))t();else{var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.onload=function(){return t()},n&&n.forEach((function(e,t){o.setAttribute(t,e)})),o.src=e,r.appendChild(o)}}},{key:"isLoaded",value:function(e){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++)if(t[n].src===e)return!0;return!1}}]),e}();function d(e){var t=new l,n=e.hostAppConfiguration.lokiUrl,r="PROD";e.settings.isSkypeWebControlIntEnvironmentEnabled?r="INT":n&&"df"===Object(a.a)(n)&&(r="DF");var i=(new o.a).set("data-environment",r).set("data-manualbootstrap","true");t.load("https://latest-swc.cdn.skype.com/sdk/v1/sdk.js",(function(){return e.dispatch(c.c())}),i)}function f(e){return"string"!=typeof e||Object(i.d)(e)}},1372:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return C})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return y}));var r=n(5),o=n.n(r),a=n(10),i=n.n(a),c=n(8),u=n.n(c),s=n(229),l=n(75),d=n(147),f=n(423),p=n(484),g=n(18),b=n(54),v=function(e,t,n,r){return new(n||(n=u.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},m="InferredContacts";function h(e,t){return e.settings.isInferredContactsEnabled&&!!t}var j=function(e){var t=e.inferredContact,n=e.person,r=e.sectionType,o=e.lpcAppContext,a=e.renderingContext,c=e.logger,u=O(t),s=C(n,t),l=[{propertyUri:"PersonaCompanyNames",value:t.Company||""},{propertyUri:"PersonaSurnames",value:t.Surname||""},{propertyUri:"PersonaGivenNames",value:t.GivenName||""},{propertyUri:"PersonaTitles",value:t.JobTitle||""},{propertyUri:"PersonaBusinessPhoneNumbers",value:t.TelephoneNumbers&&t.TelephoneNumbers[0]||""},{propertyUri:"PersonaBusinessPhoneNumbers2",value:t.TelephoneNumbers&&t.TelephoneNumbers[1]||""},{propertyUri:"PersonaTitles",value:t.JobTitle||""},{propertyUri:"PersonaEmails1",value:t.Emails&&t.Emails[0]||""},{propertyUri:"PersonaEmails2",value:t.Emails&&t.Emails[1]||""},{propertyUri:"PersonaEmails3",value:t.Emails&&t.Emails[2]||""}];t.Address&&t.Address.value&&(l=l.concat({propertyUri:"PersonaHomeAddresses",value:t.Address.value})),o.dispatch(Object(f.a)({sectionType:r}));var d={onSave:function(e){!function(e,t,n,r,o,a){v(this,void 0,void 0,i.a.mark((function c(){return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,y(e,t,r,o,a);case 2:a.logUserInteractionEvent({eventId:"PromoteInferredContactSaveButtonClickedAction",featureName:m,properties:{propertyNames:n}});case 3:case"end":return i.stop()}}),c)})))}(s,n||Object(b.a)(),u,o,a,c)},onCancel:function(){}};p.b(o,{folderId:"",createCallbacks:d,initialValues:l.filter((function(e){return""!==e.value}))})};function C(e,t){return e.email&&e.email.Address||t&&t.Emails&&t.Emails[0]||""}function O(e){if(void 0===e)return"";var t=[];return Object(s.keys)(e).forEach((function(n){void 0!==e[n]&&null!==e[n]&&t.push(n)})),t.join(",")}function y(e,t,n,r,a){return v(this,void 0,void 0,i.a.mark((function c(){return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(d.g)(e,n,r,a);case 2:return i.next=4,g.F.fetch(n,t.lpcKey,o()(o()({},Object(l.a)(t)),{locale:n.culture}));case 4:case"end":return i.stop()}}),c)})))}},1381:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return f}));var r=n(5),o=n.n(r),a={unknown_error:1,not_found:1,server_error:1,unauthorized:1,rest_provider:1,missing_rest_provider:1,host_app_callback:1};function i(e){return function(t){return"no_data"===t.state?t:"success"===t.state?o()(o()({},t),{data:e(t.data)}):o()(o()({},t),{previousData:t.previousData&&e(t.previousData)})}}function c(e){if("no_data"!==e.state)return"success"===e.state?e.data:e.previousData}function u(e,t,n){switch(e){case"idle":case"loading":return{state:"not_asked",previousData:l(t)};case"error":return{state:"error",errorCode:s(n),previousData:l(t)};case"success":return t||d;default:return d}}function s(e){return"string"==typeof e&&a.hasOwnProperty(e)?e:"unknown_error"}function l(e){switch(null==e?void 0:e.state){case"not_asked":case"error":return e.previousData;case"no_data":return;case"success":return e.data;default:return}}var d={state:"no_data"};function f(e,t){return"not_found"!==t&&"unauthorized"!==t&&e<1}},1388:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n(347),o=n(15),a=n(86),i=n(331),c=n(253),u=n(184),s=n(1363);function l(e,t,n){if(Object(u.c)(e.hostAppConfiguration.tenantAadObjectId)){var r={ConversationId:t,CorrelationId:e.cardCorrelationId,ConversationType:"person",TrafficProvider:"lpc",TrafficSource:e.hostAppConfiguration.source},o=e.ownerWindow.SkypeWebControl;if(o){o.SDK&&o.SDK.Chat&&o.SDK.Chat.isInitialized?o.SDK.Chat.startChat(r):o.SDK&&o.SDK.start&&(e.ownerWindow.addEventListener("swc:ready",(function t(){o.SDK.Chat.startChat(r),e.ownerWindow.removeEventListener("swc:ready",t)})),o.SDK.start()),Object(i.c)(e,n)}}else Object(s.b)(e),e.dispatch(Object(c.e)())}function d(e,t,n,r,i){var c=t.settings.useMicrosoftTeamsFeatures;if(Object(u.c)(t.hostAppConfiguration.tenantAadObjectId))return r&&l(t,r,n),void(i&&i());var s=t.hostAppConfiguration.actionCallbacks,d=e.imAddresses.length&&e.imAddresses[0].ImAddressUrl&&0===e.imAddresses[0].ImAddressUrl.trim().indexOf("sip:"),p=e.imAddresses.length&&e.imAddresses[0].ImAddress||"",g=e.imAddresses.length&&e.imAddresses[0].ImAddressUrl||"",b=Object(o.m)(e)||"";(d&&p&&g||c)&&s&&s.startChat?function(e,t,n,r,o,i,c,u){var s=i.startMonitor("StartWorkloadChat","WorkloadChat"),l=Object(a.a)(t.getState(),e,t.hostAppConfiguration.loggedInUserUpn);c({persona:l,smtpAddress:n,imAddress:r,imAddressUrl:o},(function(n,r){n?(u&&u(),s.success(void 0)):(f(e,t),"Tenant opted out of skype chat"===r?s.expectedFailure(r):s.unexpectedFailure(r||"Unknown"))}))}(e,t,b,p,g,n,s.startChat,i):f(e,t)}function f(e,t){var n={openType:"CurrentTab",hrefLink:e.imAddresses.length&&e.imAddresses[0].ImAddressUrl||""};Object(r.a)(n,t)}function p(e,t,n){var r=Object(u.c)(e.hostAppConfiguration.tenantAadObjectId),o=t.imAddresses.length&&t.imAddresses[0].ImAddress||""||n,a=r&&Object(s.a)(o),i=!r&&!t.imAddresses.length;return a||i}},1402:function(e,t,n){"use strict";function r(e){return function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}(e).split(".")[0]}n.d(t,"a",(function(){return r}))},1425:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(0),a=n(72),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:void 0===Object(a.a)()},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?o.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(o.Component)},1430:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="contact/contactcategories"},1431:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(51),o=n.n(r),a=n(1312),i=n(1315),c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof o.a){var a=0;for(r=o()(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(e,(function(e){return l(e,Object(i.b)(n),t)}))}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(e,(function(e){return d(e,Object(i.b)(n),t)}))}function l(e,t,n){return e.request("getContacttags","GET","/api/v1/contactTags",void 0,a.a,n,t,(function(e){return e}),a.b)}function d(e,t,n){var r=n.contactV3UpdateRequest,o=c(n,["contactV3UpdateRequest"]);return e.request("patchPeoplegraphcontact","PATCH","/api/v1/peoplegraph/contact",r,a.a,o,t,(function(e){return e}),a.b)}},1450:function(e,t,n){"use strict";function r(e){var t,n;return!!(null===(n=null===(t=e.hostAppConfiguration.dataCallbacks)||void 0===t?void 0:t.isCAPIv3Enabled)||void 0===n?void 0:n.call(t))}n.d(t,"a",(function(){return r}))},1454:function(e,t,n){"use strict";n.d(t,"m",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"q",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return j})),n.d(t,"p",(function(){return C}));var r=n(3),o=Object(r.declareString)("lpc-core.videoProfile.getVideoTitle"),a=Object(r.declareString)("lpc-core.videoProfile.getUpdateProfileVideoString"),i=Object(r.declareString)("lpc-core.videoProfile.getUploadingProgressProfileVideoString"),c=Object(r.declareString)("lpc-core.videoProfile.getUploadingFailedProfileVideoString"),u=Object(r.declareStringWithPlaceholders)("lpc-core.videoProfile.getCorrelationIdProfileVideoString"),s=Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogTitle"),l=Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogSubtext"),d=Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogCancelText"),f=Object(r.declareString)("lpc-core.videoProfile.updateProfileVideoFirstLine"),p=Object(r.declareString)("lpc-core.videoProfile.playProfileVideoFirstLine"),g=Object(r.declareString)("lpc-core.videoProfile.deleteProfileVideoFirstLine"),b=Object(r.declareString)("lpc-core.videoProfile.deleteProfileVideoConfirmationDialogue"),v=Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelButtonTitle"),m=Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelButtonLabel"),h=Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelClickOutsideLabel"),j=Object(r.declareString)("lpc-core.videoProfile.recordVideoPanelButtonLabel"),C=Object(r.declareString)("lpc-core.videoProfile.replayVideoPanelButtonLabel")},1455:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return v}));var r=n(347),o=n(350),a=n(97),i=n(111),c=n(260),u=n(465),s=n(1321),l=n(355);function d(e,t){var n=t.sourceSectionType,r=t.index,a=t.windowId,s=t.applicationContext,l=t.logger;"Card"===n||"UnknownOutsideOfExpandedView"===n?s.dispatch(Object(c.a)({indexClicked:r})):s.dispatch(Object(i.i)({shouldCloseExpandedView:!0,windowId:a||o.a,section:n,logger:l})),Object(u.g)(s,l)({recipientId:e,properties:{currentTarget:void 0,personaDisplayName:void 0,windowId:a}})}function f(e,t,n){e.dispatch(Object(c.c)({indexClicked:t}));var o=e.settings.useMicrosoftTeamsFeatures?"NewTab":"CurrentTab";if(n){var a={openType:o,hrefLink:"".concat(encodeURI(n))};Object(r.a)(a,e)}}function p(e,t,n,r,o){Object(s.g)(e,t,n,r,o)}function g(e,t){e.dispatch(Object(i.n)({personaLpcKey:t.lpcKey})),Object(l.b)(e.dispatch)}function b(e,t){e.dispatch(Object(a.i)({section:t,entryPoint:"CopyClick",viewType:"Expanded"}))}function v(e,t){e.dispatch(Object(i.j)({personaLpcKey:t.lpcKey}))}},1474:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r={UserAction:{"Overflow.Categorize.Menu.AddNewCategory":"CategorizeMenuAddNewCategoryClickAction","Overflow.Categorize.Menu.ClearAllCategories":"CategorizeMenuClearAllCategoriesClick","Overflow.Categorize.Menu.ShowAllCategories":"CategorizeMenuShowAllCategoriesClick","Overflow.Categorize.CreateCategoryModal.NewCategorySubmit":"NewContactCategoryCreateSubmitAction","Overflow.Categorize.CreateCategoryModal.NewCategoryCancel":"NewContactCategoryCreateCancelAction","Overflow.Categorize.Menu.CategoryClick":"CategorizeMenuCategoryClick"}},o={UserAction:{"ContactInfo.ContactCategoryPanel.CategoryDelete":"ContactCategoryPanelCategoryDeleteClick"}}},1490:function(e,t,n){"use strict";n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return F}));var r=n(10),o=n.n(r),a=n(8),i=n.n(a),c=n(483),u=n(356),s=n(44),l=n(45),d=n(575),f=n(1122),p=n(0),g=n(70),b=n(142),v=n(355),m=n(3),h=Object(m.declareString)("lpc-core.videoProfile.recorderTitleString"),j=Object(m.declareString)("lpc-core.videoProfile.recorderEditTitleString"),C=Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteTitleString"),O=Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteBodyString"),y=Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteConfirmString"),S=Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteCancelString"),w=Object(m.declareString)("lpc-core.videoProfile.recorderUploadButtonString"),k=n(5),x=n.n(k),P=n(228),A=n(1907),E=n(2074),I=n(1718),T=n(1953),L=n(128),D=n(684),N=n(1532),U=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};var R=Object(L.c)((function(e,t){return{retryVideoUpload:D.a.getSelectors(e).isProfileVideoRetryUpload(),unmountRecorder:D.a.getSelectors(e).isProfileVideoInitialState()}}))((function(e){var t=p.useState(void 0),n=Object(P.a)(t,2),r=n[0],a=n[1],c=p.useState(),u=Object(P.a)(c,2),s=u[0],l=u[1],d=p.useState(!0),f=Object(P.a)(d,2),g=f[0],b=f[1],v=Object(N.a)(),m=Object(N.b)();e.unmountRecorder&&s&&!g&&e.videoRecorderProps.onClose();var h=function(e){return U(void 0,void 0,void 0,o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.result)&&(b(!1),j(n));case 2:case"end":return t.stop()}}),t)})))},j=function(t){return U(void 0,void 0,void 0,o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t&&e.videoRecorderProps.handleUpdateProfileVideoClick(t).then((function(t){e.videoRecorderProps.onClose()})).catch((function(e){s||l(t)}));case 1:case"end":return n.stop()}}),n)})))};e.retryVideoUpload&&s&&(j(s),e.onProfileVideoUploadRetry()),p.useEffect((function(){var t=!1;return i.a.all([e.initializeVideoRecorder(e.appContext),e.loadResources(e.videoRecorderProps.userContext.language)]).then((function(n){var r=Object(P.a)(n,2),o=r[0].VideoRecorder,i=r[1],c=x()(x()({},e.videoRecorderProps),{localizedResources:i,onRecorderReady:h}),u=p.createElement(o,x()({},c));t||a(u)})).then((function(){return e.onLoadSuccess()})).catch((function(t){return e.onLoadFailure()})),function(){t=!0}}),[]);return p.createElement(T.a,{isOpen:g,styles:v,isBlocking:!1,layerProps:{eventBubblingEnabled:!0}},!r&&p.createElement("div",{className:m.modalWrapperStyles},p.createElement(A.a,{className:m.cancelButtonStyles,iconProps:{iconName:"Cancel"},onClick:e.videoRecorderProps.onClose}),p.createElement(E.a,{size:I.a.large,className:m.spinnerStyles})),r)})),V=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},_=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"renderVideoRecorder",value:function(e,t,n){var r,o=this;if(t){var a=this.appendRootElementIfNeededAndReturnIt(t),i=e.hostAppConfiguration,c=e.cardCorrelationId,s={onClose:function(){return o.closeVideoRecorder(a,t)},userContext:{userId:i.userAadObjectId||"",tenantId:i.tenantAadObjectId||"",language:(null===(r=i.culture)||void 0===r?void 0:r.split("-")[0])||""},hostContext:{hostSessionId:c||"",hostCorrelationId:i.consumerCorrelationId||"",hostVersion:""},handleUpdateProfileVideoClick:n};g.render(p.createElement(f.a,{context:t},p.createElement(R,{appContext:t,initializeVideoRecorder:this.initializeVideoRecorder,loadResources:this.loadResources.bind(this),videoRecorderProps:s,onLoadSuccess:function(){return e.dispatch(Object(u.i)({}))},onLoadFailure:function(){return e.dispatch(Object(u.h)({}))},onProfileVideoUploadRetry:function(){return e.dispatch(Object(u.l)({retryUpload:!1}))}})),a)}}},{key:"loadResources",value:function(e){return V(this,void 0,void 0,o.a.mark((function t(){var r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e||"en",t.next=3,n(1632)("./language-".concat(r));case 3:return a=t.sent,this.overrideWebRecorderStrings(a.default.loc.strings),t.abrupt("return",a.default);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"initializeVideoRecorder",value:function(e){return V(this,void 0,void 0,o.a.mark((function t(){var r,a=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(272),n.e(273)]).then(n.bind(null,2735));case 2:return r=t.sent,window.setTimeout((function(){return a.appendRootElementIfNeededAndReturnIt(e)}),0),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))}},{key:"appendRootElementIfNeededAndReturnIt",value:function(e){return Object(d.a)("VideoRecorderRootElement",e.getSingleton(b.a).ownerDocument)}},{key:"closeVideoRecorder",value:function(e,t){Object(v.a)(t.getSingleton(b.a).dispatch),g.unmountComponentAtNode(e)}},{key:"overrideWebRecorderStrings",value:function(e){e["capture_page.title.webcam"]=h.toString(),e["edit_page.next_button.label"]=w.toString(),e["edit_page.title"]=j.toString(),e["edit_page.recording_timeout_dialog.review.recording"]=j.toString(),e["edit_page.back_confirm_dialog.title"]=C.toString(),e["edit_page.back_confirm_dialog.confirm"]=y.toString(),e["edit_page.back_confirm_dialog.cancel"]=S.toString(),e["edit_page.back_confirm_dialog.body"]=O.toString()}}]),e}(),K=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},M=function(e,t){var n=function(n){return K(void 0,void 0,void 0,o.a.mark((function r(){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,B(n,e,t);case 2:case"end":return r.stop()}}),r)})))};window.setTimeout((function(){(new _).renderVideoRecorder(t,t.appContext,n)}),0)};function B(e,t,n){return K(this,void 0,void 0,o.a.mark((function r(){var a,i,s;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=21;break}return r.prev=1,n.dispatch(Object(u.m)({personaLpcKey:t.lpcKey})),r.next=5,Object(c.a)(n,t);case 5:if(a=r.sent,r.t0=a.SessionToken,!r.t0){r.next=10;break}return r.next=10,Object(c.d)(e,a.SessionToken,n,t);case 10:return r.next=12,Object(c.c)(t,n);case 12:i=r.sent,s=i.PlaybackUrl,n.dispatch(s?Object(u.j)({personaLpcKey:t.lpcKey}):Object(u.k)({personaLpcKey:t.lpcKey})),r.next=21;break;case 17:throw r.prev=17,r.t1=r.catch(1),n.dispatch(Object(u.k)({personaLpcKey:t.lpcKey})),r.t1;case 21:case"end":return r.stop()}}),r,null,[[1,17]])})))}function F(e,t){return K(this,void 0,void 0,o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}return n.next=3,Object(c.b)(t,e);case 3:return n.next=5,Object(c.c)(e,t);case 5:case"end":return n.stop()}}),n)})))}},1492:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(18),o=n(466),a=n(162),i=Object(a.a)((function(e){if(e&&e.InternalReplyMessage)return{start:Object(o.j)(e.DurationStartTimeUtc),end:Object(o.j)(e.DurationEndTimeUtc),message:e.InternalReplyMessage||""}})),c=Object(a.a)((function(e){if(e&&e.oofMessage)return{start:void 0,end:void 0,message:e.oofMessage||""}})),u=n(418);function s(e,t){var n=r.E.getSelectors(e).getLatestSuccess(t),o=u.a.getSelectors(e).getPersonaPresence(t);return n&&i(n)||c(o)}},1510:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(128),a=n(1339);function i(){var e=Object(o.e)();return r.useCallback((function(t,n){e(t?Object(a.b)({targetName:n}):Object(a.a)({targetName:n}))}),[e])}},1532:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(595),o=Object(r.a)((function(e){return{webRecorderCustomStyles:{selectors:{"#screenRecorderUIRoot video":{background:e.palette.white},"#screenRecorderUIRoot .fgr-videoPlayer":{background:e.palette.white},'#screenRecorderUIRoot [class^="capturePanelContainer"]':{gridTemplateRows:"minmax(60px, max-content) auto minmax(104px, max-content)",gridTemplateAreas:'"titleArea" "video" "actions"'},'[class^="overlayBackdropLight"]':{width:"252px",left:"272px"}}}}})),a=Object(r.b)({scrollableContent:{overflowY:"initial"}}),i=Object(r.b)({spinnerStyles:{height:"100%"},cancelButtonStyles:{top:"0px",right:"0px",position:"absolute"},modalWrapperStyles:{width:840,height:647}})},1632:function(e,t,n){var r={"./language-ar":[1551,20],"./language-ar.js":[1551,20],"./language-az-latn-az":[1552,34],"./language-az-latn-az.js":[1552,34],"./language-bg":[1553,44],"./language-bg.js":[1553,44],"./language-bs-latn-ba":[1554,55],"./language-bs-latn-ba.js":[1554,55],"./language-ca":[1555,66],"./language-ca.js":[1555,66],"./language-cs":[1556,21],"./language-cs.js":[1556,21],"./language-cy-gb":[1557,30],"./language-cy-gb.js":[1557,30],"./language-da":[1558,31],"./language-da.js":[1558,31],"./language-de":[1559,32],"./language-de.js":[1559,32],"./language-el":[1560,33],"./language-el.js":[1560,33],"./language-en":[1562,19],"./language-en-gb":[1561,35],"./language-en-gb.js":[1561,35],"./language-en.js":[1562,19],"./language-es":[1564,37],"./language-es-mx":[1563,36],"./language-es-mx.js":[1563,36],"./language-es.js":[1564,37],"./language-et":[1565,38],"./language-et.js":[1565,38],"./language-eu":[1566,39],"./language-eu.js":[1566,39],"./language-fi":[1567,40],"./language-fi.js":[1567,40],"./language-fil-ph":[1568,41],"./language-fil-ph.js":[1568,41],"./language-fr":[1570,43],"./language-fr-ca":[1569,42],"./language-fr-ca.js":[1569,42],"./language-fr.js":[1570,43],"./language-ga-ie":[1571,45],"./language-ga-ie.js":[1571,45],"./language-gl":[1572,46],"./language-gl.js":[1572,46],"./language-he":[1573,47],"./language-he.js":[1573,47],"./language-hi":[1574,48],"./language-hi.js":[1574,48],"./language-hr":[1575,49],"./language-hr.js":[1575,49],"./language-hu":[1576,50],"./language-hu.js":[1576,50],"./language-id":[1577,51],"./language-id.js":[1577,51],"./language-is":[1578,52],"./language-is.js":[1578,52],"./language-it":[1579,53],"./language-it.js":[1579,53],"./language-ja":[1580,54],"./language-ja.js":[1580,54],"./language-ka":[1581,56],"./language-ka.js":[1581,56],"./language-kk":[1582,57],"./language-kk.js":[1582,57],"./language-ko":[1583,58],"./language-ko.js":[1583,58],"./language-lt":[1584,59],"./language-lt.js":[1584,59],"./language-lv":[1585,60],"./language-lv.js":[1585,60],"./language-mk":[1586,61],"./language-mk.js":[1586,61],"./language-ms":[1587,62],"./language-ms.js":[1587,62],"./language-nb-no":[1588,63],"./language-nb-no.js":[1588,63],"./language-nl":[1589,64],"./language-nl.js":[1589,64],"./language-nn-np":[1590,65],"./language-nn-np.js":[1590,65],"./language-pl":[1591,67],"./language-pl.js":[1591,67],"./language-prs-af":[1592,68],"./language-prs-af.js":[1592,68],"./language-pt-br":[1593,69],"./language-pt-br.js":[1593,69],"./language-pt-pt":[1594,70],"./language-pt-pt.js":[1594,70],"./language-ro":[1595,71],"./language-ro.js":[1595,71],"./language-ru":[1596,72],"./language-ru.js":[1596,72],"./language-sk":[1597,73],"./language-sk.js":[1597,73],"./language-sl":[1598,74],"./language-sl.js":[1598,74],"./language-sq":[1599,75],"./language-sq.js":[1599,75],"./language-sr-cyrl-rs":[1600,76],"./language-sr-cyrl-rs.js":[1600,76],"./language-sr-latn-rs":[1601,22],"./language-sr-latn-rs.js":[1601,22],"./language-sv":[1602,23],"./language-sv.js":[1602,23],"./language-th":[1603,24],"./language-th.js":[1603,24],"./language-tr":[1604,25],"./language-tr.js":[1604,25],"./language-uk":[1605,26],"./language-uk.js":[1605,26],"./language-vi":[1606,27],"./language-vi.js":[1606,27],"./language-zh-cn":[1607,28],"./language-zh-cn.js":[1607,28],"./language-zh-tw":[1608,29],"./language-zh-tw.js":[1608,29]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((function(){return n.t(o,7)}))}o.keys=function(){return Object.keys(r)},o.id=1632,e.exports=o},1662:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(115);function o(e,t){var n,o=e.hostAppConfiguration.actionCallbacks;if(o&&o.onTagClick)try{t&&(null===(n=o.onTagClick)||void 0===n||n.call(o,t.name))}catch(e){Object(r.c)("onTagClick action callback failed: "+e)}}},1684:function(e,t,n){"use strict";var r=n(704);var o=function(e,t,n){var o=e.length;return n=void 0===n?o:n,!t&&n>=o?e:Object(r.a)(e,t,n)},a=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var i=function(e){return a.test(e)};var c=function(e){return e.split("")},u="[\\ud800-\\udfff]",s="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",l="\\ud83c[\\udffb-\\udfff]",d="[^\\ud800-\\udfff]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",g="(?:"+s+"|"+l+")"+"?",b="[\\ufe0e\\ufe0f]?"+g+("(?:\\u200d(?:"+[d,f,p].join("|")+")[\\ufe0e\\ufe0f]?"+g+")*"),v="(?:"+[d+s+"?",s,f,p,u].join("|")+")",m=RegExp(l+"(?="+l+")|"+v+b,"g");var h=function(e){return e.match(m)||[]};var j=function(e){return i(e)?h(e):c(e)},C=n(478);var O=function(e){return function(t){t=Object(C.a)(t);var n=i(t)?j(t):void 0,r=n?n[0]:t.charAt(0),a=n?o(n,1).join(""):t.slice(1);return r[e]()+a}}("toUpperCase");t.a=O},1689:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return U}));var r=n(2051),o=n(1413),a=n(1248),i=n(0),c=n(1455),u=n(356),s=n(1287),l=n(1510),d=n(13),f=Object(d.db)({marginLeft:"-28px",marginRight:"-28px"}),p={panel:{panelContent:function(){return{panel:{padding:"12px 0 0"}}}}},g={contactPanelContainer:function(){return{contentContainer:{marginRight:0}}}},b=n(79),v=n.n(b),m=n(168),h=n.n(m),j=n(107),C=n.n(j),O=n(206),y=n.n(O),S=n(7),w=n(162),k=n(470);function x(e,t){var n=void 0!==C.a&&e[h.a]||e["@@iterator"];if(!n){if(v()(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return y()(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=Object(w.a)((function(e,t,n,r,o,a){var i,c=[],u=x(e);try{var s=function(){var e=i.value;c=c.concat(e.content?e.content.map((function(i,c){return T({firstLine:i.displayString,secondLine:void 0,contactLinkType:e.contactType,index:c,lpcAppContext:t,emailClicked:n,startChatClicked:r,callPhoneClicked:o,updateProfileVideoClicked:a,href:i.hrefLink,contactLinkSubType:i.fieldType,linkIcon:i.linkIcon})})):[])};for(u.s();!(i=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}return c})),E=Object(w.a)((function(e,t,n,r,o,a,i,c,u,s){var l,d=[],f=x(e);try{for(f.s();!(l=f.n()).done;){var p=l.value,g=I(p);d=d.concat("unknown"!==g&&p.firstLine?T({firstLine:p.firstLine,secondLine:p.secondLine,contactLinkType:g,index:0,lpcAppContext:t,emailClicked:r,startChatClicked:o,callPhoneClicked:a,updateProfileVideoClicked:i,retryProfileVideoUploadClicked:c,href:p.url,contactLinkSubType:p.contactInfoType,linkIcon:p.icon,label:p.label,tooltip:p.tooltip,dataSources:p.source,fallbackDataSource:p.fallbackSource,person:u,dataSourceLabels:n,consumerChatHandle:s}):[])}}catch(e){f.e(e)}finally{f.f()}return d}));function I(e){var t=e.label?e.label.replace(/\s/g,"").toLowerCase():"unknown";return"unknown"!==e.contactLinkType?e.contactLinkType:t}var T=Object(w.a)((function(e){var t=e.firstLine,n=e.secondLine,r=e.contactLinkType,o=e.index,a=e.lpcAppContext,i=e.emailClicked,c=e.startChatClicked,u=e.callPhoneClicked,s=e.updateProfileVideoClicked,l=e.retryProfileVideoUploadClicked,d=e.href,f=e.contactLinkSubType,p=e.linkIcon,g=e.label,b=e.tooltip,v=e.dataSources,m=e.fallbackDataSource,h=e.person,j=e.dataSourceLabels,C=e.consumerChatHandle,O=0===o?p||D(r):void 0;return{label:g,showInferredData:a.settings.isInferredContactsEnabled,isInferredData:v&&1===v.length&&v[0]===k.a,labelHoverText:j&&v&&function(e,t){var n=t.foundInEmail;if(!e)return"";return 1===e.length&&e[0]===k.a?n:e.filter((function(e){return e&&e!==k.a})).map((function(e){return function(e,t){switch(e){case"Directory":return t.sourceDirectory;case"Contact":return t.sourceContact;case"Custom":return t.sourceCustom;default:return e}}(e,t)})).join(t.dataSourceSeparator)}(v,j)||m,contactLinkType:r,contactLinkSubType:f,firstLine:t,secondLine:n,firstLineHoverText:b,icon:O,onClick:L(t,r,o,i,c,u,s,l,d,h,C,f)}}));var L=Object(w.a)((function(e,t,n,r,o,a,i,c,u,s,l,d){var f=c?function(){return c()}:void 0;switch(t){case"email":return r?function(){return r(e,n)}:void 0;case"phone":case"mobile":case"workphone":return u&&d&&a?function(){return a(u,d,n)}:void 0;case"chat":return s&&o?function(){return o(s,e,l)}:void 0;case"updateprofilevideo":return i?function(){return i()}:void 0;case"uploadfailprofilevideo":return f;default:return}})),D=Object(w.a)((function(e){switch(e){case"email":return S.b.Mail;case"phone":return S.b.Phone;case"website":return S.b.Globe;case"location":return S.b.Location;case"timezone":return S.b.Clock;case"updateprofilevideo":return S.b.VideoAdd;default:return S.b.People}}));function N(e){var t=e.onTitleClick,n=e.onFooterClick,o=e.onUpdateProfileVideoClick,u=e.contacts,d=e.showLoading,f=e.showError,p=void 0!==f&&f,b=e.additionalChildren,v=e.additionalAvailabilityInfo,m=e.hideTitle,h=Object(s.a)(),j=Object(a.b)(),C=A(u,h,(function(e,t){return Object(c.c)(e,{sourceSectionType:"Card",index:t,applicationContext:h,logger:j})}),(function(e,t){return Object(c.a)(h,e,"Card",j)}),(function(e,t,n){return Object(c.d)(h,n,e)}),(function(){o&&o()})),O=v&&v.length?A(v,h):void 0,y=Object(l.a)();return i.createElement(r.a,{logName:"UserInfoBlock",showLoading:d,showError:p,onTitleClick:h.settings.useMicrosoftTeamsFeatures?void 0:t,onFooterClick:n,contacts:C,additionalChildren:b,additionalAvailabilityInfo:O,hideFooter:h.settings.useMicrosoftTeamsFeatures,hideTitle:m,onCopied:y,styleOverrides:g})}function U(e){var t=e.onFooterClick,n=e.onUpdateProfileVideoClick,d=e.onPlayProfileVideoClick,g=e.onDeleteProfileVideoClick,b=e.onContactPopupOpened,v=e.contacts,m=e.showLoading,h=e.showError,j=void 0!==h&&h,C=e.hideFooter,O=void 0===C||C,y=e.person,S=e.sectionType,w=e.consumerChatHandle,k=e.additionalChildren,x=e.additionalAvailabilityInfo,P=Object(s.a)(),A=Object(a.b)(),I=Object(o.e)(),T=function(){y&&P.dispatch(Object(u.l)({retryUpload:!0}))},L=E(v,P,I,(function(e,t){return Object(c.c)(e,{sourceSectionType:S,index:t,applicationContext:P,logger:A})}),(function(e,t,n){return Object(c.a)(P,e,S,A,n)}),(function(e,t,n){return Object(c.d)(P,n,e)}),(function(){n&&n()}),T,y,w),D=P.settings.isRichAvailabilityInfoEnabled&&x&&x.length?E(x,P,I,void 0,void 0,void 0,(function(){n&&n()}),T):void 0,N=Object(l.a)(),U={handleDeleteProfileVideo:g,handlePlayProfileVideo:d};return i.createElement("div",{className:f},i.createElement(r.a,{logName:"UserInfoBlockLarge",showLoading:m,showError:j,onFooterClick:t,contacts:L,additionalChildren:k,additionalAvailabilityInfo:D,hideFooter:O,onCopied:N,showLargeLink:!0,profileVideoProperties:U,onContactPopupOpened:b,styleOverrides:p}))}},1738:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return b}));var r=n(57),o=n.n(r),a=n(8),i=n.n(a),c=n(88),u=n.n(c),s=n(2),l=n(114),d=n(36),f=n(601),p=(n(904),n(286));function g(e){return v("Loki",e)}function b(e){var t=v("HostApp",e);return function(e){return t((function(){return e}))}}function v(e,t){var n=Object(f.c)();return h(e,t,n)}var m=function(e,t,n){return Object(s.__assign)(Object(s.__assign)({},Object(p.a)(t,n)),{duration:e.duration,errorCode:e.errorCode,misc:u()(e.misc),requestCorrelationId:e.requestCorrelationId,responseCorrelationId:e.responseCorrelationId,result:e.result,scenario:e.fetch.scenario,source:e.source})},h=function(e,t,n){return function(r){return function(){return new i.a((function(a){var i=o()(),c={requestId:Object(d.a)(),clientScenario:t.scenario,hostAppApp:n.appSessionProps.hostAppApp};a(r(c)().then((function(r){if("success"===r.state||"no_data"===r.state||"error"===r.state){var a=o()()-i,u=j(r,t),s={source:e,fetch:t,misc:u,requestCorrelationId:c.requestId,responseCorrelationId:void 0,duration:a,result:r.state};"error"===r.state&&(s.errorCode=r.errorCode),function(e,t){var n=t.telemetryCallbacks,r=t.hostAppSessionProps,o=t.appSessionProps;n.logFetchEvent(m(e,r,o))}(s,n)}return r})))}))}}},j=function(e,t){var n,r,o;switch(e.state){case"success":return null===(n=t.getMisc)||void 0===n?void 0:n.call(t,e.data);case"error":return null===(r=t.getMisc)||void 0===r?void 0:r.call(t,e.previousData);case"no_data":return null===(o=t.getMisc)||void 0===o?void 0:o.call(t,void 0);default:Object(l.a)(e)}}},1840:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(228),o=n(421),a=n(604),i=n(1381);function c(e,t){var n=Object(a.c)(),c=Object(o.e)(e,function(e,t){return{onMutate:function(n){var r;return null===(r=null==t?void 0:t.onMutate)||void 0===r?void 0:r.call(t,e,n)},onSuccess:function(n,r){var o;return null===(o=null==t?void 0:t.onSuccess)||void 0===o?void 0:o.call(t,e,n,r)},onError:function(n,r,o){var a;return null===(a=null==t?void 0:t.onError)||void 0===a?void 0:a.call(t,e,n,r,o)},onSettled:function(n,r,o,a){var i;return null===(i=null==t?void 0:t.onSettled)||void 0===i?void 0:i.call(t,e,n,r,o,a)},throwOnError:Boolean(null==t?void 0:t.throwOnError)}}(n,t)),u=Object(r.a)(c,2),s=u[0],l=u[1],d=l.data,f=l.status,p=l.error;return[s,Object(i.d)(f,d,p)]}},1871:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(1313),o=n(1294),a=n(29),i=n(213),c=n(1134),u=n(358),s=n(270);function l(e,t){var n=[],r=[],o=e.map((function(e){return e&&e.toLowerCase()}));return e.forEach((function(e,a){o.indexOf(e&&e.toLowerCase())===a&&(r.push(t[a]),n.push(e))})),n.map((function(e,t){return{displayString:e,hrefLink:r[t]}}))}function d(e){if(Object(a.p)(e)){if(!Object(i.d)(e.officeLocation))return{address:e.officeLocation,locationType:"OfficeLocation"};if(e.postalAddresses.length>0){var t=Object(c.a)(e.postalAddresses,(function(e){return"Business"===e.Type}));if(t)return{address:Object(u.a)(t),locationType:"BusinessAddress"};if(t=Object(c.a)(e.postalAddresses,(function(e){return"Home"===e.Type})))return{address:Object(u.a)(t),locationType:"HomeAddress"};var n=e.postalAddresses[0];if(void 0!==n)return{address:Object(u.a)(n),locationType:"PostalAddress"}}}return{address:"",locationType:"PostalAddress"}}function f(e,t,n){var a=Object(r.c)(e,t),i=Object(o.c)(e,t.timeFormats);return{fieldType:"TimeZone",displayString:Object(o.d)(a,i,n)}}function p(e,t,n,r,a,i,c){var u;if(t){var l=null!==(u=function(e,t,n,r,a,i,c){var u,s,l,d,f,p=null!==(u=n.isOutOfOffice)&&void 0!==u&&u;return f=p?Object(o.b)(null==t?void 0:t.end,a,c):Object(o.a)(null!==(s=null==e?void 0:e.UtcDateTime)&&void 0!==s?s:void 0,null!==(l=null==e?void 0:e.CurrentStatus)&&void 0!==l?l:void 0,null!==(d=null==e?void 0:e.NextStatus)&&void 0!==d?d:void 0,a,c),""===r||!f||i||p?p&&f?f:r:Object(o.g)({presence:r,nextAvailability:f})}(e,n,t,r,a,i,c))&&void 0!==u?u:"",d=function(e){return Object(s.b)(null==e?void 0:e.presence,e.isOutOfOffice)}(t);if(d&&""!==l)return{linkIcon:d,fieldType:"NextAvailability",displayString:l}}}},1919:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(903),o=n(904),a=n(1254),i=n(1279),c=n(601),u=n(905),s=n(0),l=n(114);var d=function(e){switch(e){case"success":case"no_data":return"Success";case"error":return"UnexpectedFailure";default:return Object(l.b)(e,"Unknown")}},f=function(e){return e&&JSON.parse(e)},p=function(e){var t=e.logger,n=e.featureName,l=e.eventFieldMap,p=e.getRenderScenario,g=e.children,b={telemetryCallbacks:function(e,t,n){return{logSessionStartEvent:function(e){},logSessionEndEvent:function(e){},logUserActionEvent:function(r){var o=[r.path,r.moduleName,r.action].join("."),a=n.UserAction,i=a&&a[o]||o,c={exportType:"UserInteraction",exportName:"".concat(r.moduleName,"_").concat(r.action)};e.logEvent({eventId:i,featureName:t,properties:f(r.misc),exportOptions:c})},logFetchEvent:function(r){var o=n.Fetch,a=o&&o[r.scenario]||r.scenario;e.logQoS(a,d(r.result),r.result.toString(),t,r.duration,r.source,r.requestCorrelationId||"",f(r.misc))},logRenderEvent:function(n){var r=n.action,o=n.state,a=n.targetView,i=n.components,c=n.componentsWithError,u=n.duration,s=n.preRenderLatency,l=n.renderLatency,d=n.eupl;e.logEUPL("".concat(r,"-eupl"),t,u,{action:r,state:o,targetView:a,components:i,componentsWithError:c,duration:u.toString(),preRenderLatency:(null==s?void 0:s.toString())||"",renderLatency:(null==l?void 0:l.toString())||"",eupl:(null==d?void 0:d.toString())||""})},logErrorEvent:function(n){n.midgardError&&e.logError({eventId:n.midgardError.family+"-error",featureName:t,properties:{midgardError:n.midgardError}})},registerErrors:function(t,n){e.registerErrors(t,n)},lookupError:function(e){return["",void 0,""]},errorMap:{}}}(t,n,l),hostAppSessionProps:r.a,appSessionProps:o.a},v=s.useCallback((function(){return Object(a.a)()}),[]),m=Object(i.b)(b,p||v,(function(){return""}));return s.createElement(c.a,{telemetry:b,getSize:function(){return""}},s.createElement(u.a.Provider,{value:m},g))}},1924:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(1128),a=n(1381),i=n(1840),c=n(1431),u=n(1738),s=n(672),l=n(1430);function d(){var e=Object(s.b)(),t=Object(u.b)({scenario:"CategoriesPatch"});return Object(i.a)((function(n){var r,o="DELETE"===n.action?(r=n.category,{id:n.contactId,tags:r.map((function(e){return{id:e.id,action:"DELETE"}}))}):function(e,t){return{id:t,tags:[{action:"POST",body:{displayName:e.name,color:{backgroundColor:e.color}}}]}}(n.category,n.contactId);return t((function(t){return Object(c.a)(e,{contactV3UpdateRequest:o},t)}))().then(Object(a.e)(f))}),{onMutate:function(e,t){var n=e.getQueryData([l.a,{contactId:t.contactId}]);e.cancelQueries([l.a,{contactId:t.contactId}]);var o=Object(a.b)(n)||[],i="POST"===t.action?o.concat(Object(r.__assign)(Object(r.__assign)({},t.category),{creationTime:(new Date).toUTCString()})):o.filter((function(e){return!t.category.some((function(t){return t.name===e.name}))}));return e.setQueryData([l.a,{contactId:t.contactId}],{state:"success",data:i}),{state:"success",data:i}},onSuccess:function(e,t,n){"success"===t.state&&e.setQueryData([l.a,{contactId:n.contactId}],{state:"success",data:Object(a.b)(t)||[]})}})}function f(e){if(e)return(e.tags||[]).filter((function(e){return e.displayName&&e.id})).map((function(e){var t;return{name:e.displayName||"",id:e.id||"",creationTime:e.createdDateTime||"",color:Object(o.b)(null===(t=e.color)||void 0===t?void 0:t.backgroundColor)}}))}},2061:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(7),o=n(0),a=n(1494),i=n(1485),c=n(937),u=n(112),s=n(13),l=Object(u.c)((function(e,t){return Object(s.cb)({container:{padding:t?"10px 12px":"0 24px",display:"flex",flexFlow:"row wrap",margin:0},content:{fontSize:t?e.fonts.medium.fontSize:e.fonts.small.fontSize,maxWidth:"100%",display:"block",flex:"1 1 0%"},tagContent:{padding:"".concat(e.spacing.s2," 0")}})})),d=function(e){var t=e.tagIcon,n=e.tagHeader,r=e.tagContent,a=e.isLarge,i=l(Object(c.a)(),a);return o.createElement("div",{className:i.container},t,o.createElement("div",{className:i.content},n,o.createElement("div",{className:i.tagContent},r)))},f=n(3),p=n(30),g=Object(f.declareString)("lpc-contact-ui.contactLinkBlockUIStrings.tagLabel");function b(e){var t=e.isLarge,n=e.tagList,c={tag:Object(p.a)(g)},u=t?o.createElement(a.a,{label:c.tag}):void 0,s=o.createElement(i.a,{icon:r.b.Category,isLarge:t});return o.createElement(d,{tagHeader:u,tagIcon:s,tagContent:n,isLarge:t})}},2100:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),o=n(1924),a=n(282),i=n(665),c=n(0),u=n.n(c),s=u.a.lazy((function(){return n.e(95).then(n.bind(null,2712))}));function l(e){return u.a.createElement(u.a.Suspense,{fallback:null},u.a.createElement(i.a,{name:"ContactCategoryPanel"},u.a.createElement(s,Object(r.__assign)({},e))))}function d(e){var t=this,n=e.tags,i=e.showAll,s=e.showDelete,d=e.contactId,f=e.onTagDelete,p=e.onShowMoreClick,g=e.onTagClick,b=e.onCategoryAddClick,v=Object(r.__read)(Object(o.a)(),1)[0],m=Object(c.useCallback)((function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return null==f||f({status:a.b.Pending,tags:[e]}),[4,v({contactId:d,action:"DELETE",category:[e]})];case 1:return t=r.sent(),(n=t&&"success"===t.state&&t.data?null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.filter((function(t){return t.name===e.name})):[]).length&&(null==f||f({status:a.b.Failed,tags:n})),[2]}}))}))}),[f,v,d]);return u.a.createElement(l,{tags:n,showAll:i,showDelete:s,onTagDelete:m,onShowMoreClick:p,onTagClick:g,onCategoryAddClick:b})}}}]);